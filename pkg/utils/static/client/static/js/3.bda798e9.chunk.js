(this["webpackJsonpnervatura-client"]=this["webpackJsonpnervatura-client"]||[]).push([[3],{620:function(e,t,r){e.exports={pdfPage:"Report_pdfPage__33_9q"}},621:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return o}));var n=r(6),a=r(620),c=r.n(a),i=r(0),l=Object(n.memo)((function(e){var t=e.viewerRef,r=e.canvasRef,n=e.theme;return Object(i.jsx)("div",{ref:t,className:"page padding-normal".concat(" ",n),children:Object(i.jsx)("div",{className:"section center",children:Object(i.jsx)("canvas",{ref:r,className:"".concat(c.a.pdfPage)})})})}),(function(e,t){return e.canvasRef.current===t.canvasRef.current})),o=function(e,t,r){var n=r||{},a=n.scale,c=n.page;if(c&&e&&t){var i=e,l=t,o=l.getContext("2d"),u=c.getViewport({scale:1});"page-width"===a?u=c.getViewport({scale:(i.clientWidth-48)/u.width}):1!==a&&(u=c.getViewport({scale:a})),l.width=u.width,l.height=u.height,c.render({canvasContext:o,viewport:u})}}},624:function(e,t,r){e.exports={formPanel:"Editor_formPanel__2cx4X",width800:"Editor_width800__AyuHl",viewPanel:"Editor_viewPanel__2mit5",badge:"Editor_badge__8xIEB",tabButton:"Editor_tabButton__2CKyS",paginatorCell:"Editor_paginatorCell__1dexB",addButton:"Editor_addButton__3jgrx",editCol:"Editor_editCol__3PEyD",deleteCol:"Editor_deleteCol__3iqYY",totalLabel:"Editor_totalLabel__2_DIJ",totalValue:"Editor_totalValue__-MCrD",rtfEditor:"Editor_rtfEditor__vebXj",barButton:"Editor_barButton__3XBE9",activeStyle:"Editor_activeStyle__C36kw",itemTitle:"Editor_itemTitle__3cUzb",itemTitlePre:"Editor_itemTitlePre__16nbZ",closeIcon:"Editor_closeIcon__3ND9X",pdfPage:"Editor_pdfPage__4BMe3"}},628:function(e,t,r){"use strict";r.r(t);var n=r(14),a=r(10),c=r.n(a),i=r(16),l=r(13),o=r(31),u=r(6),s=r(1),d=r.n(s),m=r(282),b=r(30),f=r(24),p=r(18),j=r(62),v=r(81),g=r(621),x=r(624),O=r.n(x),_=r(7),h=r(65),y=r(5),w=r(148),k=r(191),N=r(0),F=Object(u.memo)((function(e){var t=e.currentView,r=e.getText,n=e.editItem,a=e.data,c=a.current,i=a.template,l=a.audit,o=a.dataset,s=c.item[i.options.title_field];return"printqueue"===c.type?s=i.options.title_field:null===c.item.id&&(s=r("label_new")+" "+i.options.title),Object(N.jsxs)(u.Fragment,{children:[Object(N.jsx)("div",{className:"row full",children:Object(N.jsx)("div",{className:"cell",children:Object(N.jsx)("button",{className:" ".concat(O.a.tabButton," ","full secondary-title"),onClick:function(){return t("form")},children:Object(N.jsx)(_.d,{value:s,leftIcon:Object(u.createElement)(i.options.icon),col:20})})})}),"form"===c.view?Object(N.jsxs)("div",{className:"".concat(O.a.formPanel," ","border"),children:[i.rows.map((function(e,t){return Object(N.jsx)(_.b,{row:e,values:c.item,rowdata:{audit:l,current:c,dataset:o,onEdit:n}},t)})),"report"===c.type&&c.fieldvalue.length>0?Object(N.jsx)("div",{className:"row full",children:c.fieldvalue.map((function(e,t){return Object(N.jsx)(_.b,{row:e,values:e,rowdata:{audit:l,current:c,dataset:o,onEdit:n}},t)}))}):null]}):null]})}),(function(e,t){return e.data===t.data})),$=Object(u.memo)((function(e){var t=e.currentView,r=e.editItem,n=e.checkEditor,a=e.onPaginationSelect,c=e.data,i=c.current,l=c.template,o=c.dataset,s=c.audit;if((null!==i.item.id||l.options.search_form)&&"undefined"!==typeof o.fieldvalue&&null!==i.item&&!0===l.options.fieldvalue){var m=[];i.fieldvalue.forEach((function(e){var t=o.deffield.filter((function(t){return t.fieldname===e.fieldname}))[0];if(1===t.visible&&0===e.deleted){var r=o.groups.filter((function(e){return e.id===t.fieldtype}))[0].groupvalue,n=e.value,a=r;switch(r){case"customer":case"tool":case"trans":case"transitem":case"transmovement":case"transpayment":case"product":case"project":case"employee":case"place":var c=o.deffield_prop.filter((function(t){return t.ftype===r&&t.id===parseInt(e.value,10)}))[0];c&&(n=c.description),a="selector";break;case"urlink":a="text";break;case"valuelist":n=t.valuelist.split("|")}m=d()(m,{$push:[{rowtype:"fieldvalue",id:e.id,name:"fieldvalue_value",fieldname:e.fieldname,value:e.value,notes:e.notes||"",label:t.description,description:n,disabled:!!t.readonly,fieldtype:r,datatype:a}]})}}));var b=i.pagination.perPage>0?Object(h.b)(i.pagination)(m):m;return Object(N.jsxs)(u.Fragment,{children:[Object(N.jsx)("div",{className:"row full",children:Object(N.jsx)("div",{className:"cell",children:Object(N.jsx)("button",{className:" ".concat(O.a.tabButton," ","full secondary-title"),onClick:function(){return t("fieldvalue")},children:Object(N.jsxs)("div",{className:"row full",children:[Object(N.jsx)("div",{className:"cell",children:Object(N.jsx)(_.d,{text:"fields_view",leftIcon:Object(u.createElement)(l.options.icon),col:20})}),Object(N.jsx)("div",{className:"cell align-right",children:Object(N.jsx)("span",{className:"".concat(O.a.badge),children:m.length})})]})})})}),"fieldvalue"===i.view?Object(N.jsxs)("div",{className:"".concat(O.a.formPanel," ","border"),children:["readonly"!==s||b.amount&&b.amount>1?Object(N.jsxs)("div",{className:"row full container-small section-small border-bottom",children:["readonly"!==s?Object(N.jsxs)("div",{className:"cell mobile",children:[Object(N.jsx)("div",{className:"cell padding-small",children:Object(N.jsx)(_.e,{value:i.deffield||"",keys:["edit","current","deffield"],placeholder:"",options:function(){var e=o.groups.filter((function(e){return"nervatype"===e.groupname&&e.groupvalue===i.type}))[0].id;return"trans"===i.type?o.deffield.filter((function(t){return t.nervatype===e&&1===t.visible})).filter((function(e){return e.subtype===i.item.transtype||null===e.subtype})).map((function(e){return{value:e.fieldname,text:e.description}})):o.deffield.filter((function(t){return t.nervatype===e&&1===t.visible})).map((function(e){return{value:e.fieldname,text:e.description}}))}()})}),i.deffield&&""!==i.deffield?Object(N.jsx)("div",{className:"cell",children:Object(N.jsx)("button",{className:"border-button".concat(" ",O.a.addButton),onClick:function(){return n({fieldname:i.deffield},"NEW_FIELDVALUE")},children:Object(N.jsx)(_.d,{text:"label_new",leftIcon:Object(N.jsx)(y.bb,{}),col:20})})}):null]}):null,b.amount&&b.amount>1?Object(N.jsx)("div",{className:" ".concat(O.a.paginatorCell," ","cell right mobile"),children:Object(N.jsx)(h.a,{pagination:i.pagination,pages:b.amount,onSelect:function(e){a(e,m.length)}})}):null]}):null,(b.rows||b).map((function(e,t){return Object(N.jsx)(_.b,{row:e,values:e,rowdata:{audit:s,current:i,dataset:o,onEdit:r}},e.id)}))]}):null]})}return null}),(function(e,t){return e.data===t.data})),E=Object(u.memo)((function(e){var t=e.currentView,r=e.getText,a=e.setActions,c=e.formatNumber,i=e.vname,l=e.data,o=l.current,s=l.template,m=l.dataset,b=l.audit,f=e.ui,p=f.paginationPage,j=f.dateFormat,v=f.timeFormat,g=s.view[i],x=m[g.data]||[],h=g.edited||!0,F=g.actions;"undefined"===typeof F&&(F={new:{action:"newEditorItem",fkey:i},edit:{action:"editEditorItem",fkey:i},delete:{action:"deleteEditorItem",fkey:i}}),"all"!==b&&(F=d()(F,{$merge:{new:null,delete:null}}));var $="undefined"!==typeof g.edit_icon?g.edit_icon:y.B,E="undefined"!==typeof g.delete_icon?g.delete_icon:y.tb,C="undefined"!==typeof g.new_icon?g.new_icon:y.bb,I={};return"table"===g.type&&(h&&(F.edit||F.delete)&&(I=d()(I,{$merge:{edit:{columnDef:{property:"edit",cell:{props:{style:{width:30,padding:"7px 3px 3px 8px"}},formatters:[function(e,t){var r=t.rowData,n=null!==F.edit?Object(N.jsx)("div",{className:"cell".concat(" ",O.a.editCol),children:Object(u.createElement)($,{width:24,height:21.3,onClick:function(){return a(F.edit,r)},className:O.a.editCol})}):null,c=null!==F.delete?Object(N.jsx)("div",{className:"cell".concat(" ",O.a.deleteCol),children:Object(u.createElement)(E,{width:19,height:27.6,onClick:function(){return a(F.delete,r)},className:O.a.deleteCol})}):null;return Object(N.jsxs)(u.Fragment,{children:[n,c]})}]}}}}})),I=d()(I,{$merge:Object(n.a)({},g.fields)})),Object(N.jsxs)(u.Fragment,{children:[Object(N.jsx)("div",{className:"row full",children:Object(N.jsx)("div",{className:"cell",children:Object(N.jsx)("button",{className:" ".concat(O.a.tabButton," ","full secondary-title"),onClick:function(){return t(i)},children:Object(N.jsxs)("div",{className:"row full",children:[Object(N.jsx)("div",{className:"cell",children:Object(N.jsx)(_.d,{value:g.title,leftIcon:Object(u.createElement)(g.icon),col:20})}),Object(N.jsx)("div",{className:"cell align-right",children:Object(N.jsx)("span",{className:"".concat(O.a.badge),children:x.length})})]})})})}),o.view===i?Object(N.jsxs)("div",{className:"".concat(O.a.viewPanel),children:[g.total?Object(N.jsxs)("div",{className:"row full border",children:[Object(N.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[Object(N.jsx)("span",{className:"".concat(O.a.totalLabel),children:g.total[Object.keys(g.total)[0]]+":"}),Object(N.jsx)("span",{className:"".concat(O.a.totalValue," ","border"," "),children:c(m[o.type][0][Object.keys(g.total)[0]],m[o.type][0].digit||2)})]}),Object(N.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[Object(N.jsx)("span",{className:"".concat(O.a.totalLabel),children:g.total[Object.keys(g.total)[1]]+":"}),Object(N.jsx)("span",{className:"".concat(O.a.totalValue," ","border"),children:c(m[o.type][0][Object.keys(g.total)[1]],m[o.type][0].digit||2)})]}),Object(N.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[Object(N.jsx)("span",{className:"".concat(O.a.totalLabel),children:g.total[Object.keys(g.total)[2]]+":"}),Object(N.jsx)("span",{className:"".concat(O.a.totalValue," ","border"),children:c(m[o.type][0][Object.keys(g.total)[2]],m[o.type][0].digit||2)})]})]}):null,Object(N.jsx)("div",{className:"row full",children:"table"===g.type?Object(N.jsx)(w.a,{rowKey:"id",onAddItem:h&&null!==F.new?function(){return a(F.new)}:null,fields:I,rows:x,tableFilter:!0,filterPlaceholder:r("placeholder_filter"),labelYes:r("label_yes"),labelNo:r("label_no"),labelAdd:"undefined"!==typeof g.new_label?g.new_label:r("label_new"),addIcon:C,dateFormat:j,timeFormat:v,paginationPage:p,paginationTop:!0}):Object(N.jsx)(k.a,{rows:x,labelAdd:"undefined"!==typeof g.new_label?g.new_label:r("label_new"),addIcon:C,editIcon:$,deleteIcon:E,listFilter:!0,filterPlaceholder:r("placeholder_filter"),paginationPage:p,paginationTop:!0,onEdit:h&&null!==F.edit?function(e){return a(F.edit,e)}:null,onAddItem:h&&null!==F.new?function(){return a(F.new)}:null,onDelete:h&&null!==F.delete?function(e){return a(F.delete,e)}:null})})]}):null]})}),(function(e,t){return e.data===t.data})),C=Object(u.memo)((function(e){var t=e.noteChange,r=e.currentView,n=e.noteState,a=e.getText,c=e.noteTemplate,i=e.setPattern,l=e.ui,o=l.rtf_inline,s=l.rtf_block,d=e.data,m=d.current,f=d.template,p=d.audit,j=d.dataset;if(null!==m.item.id&&"undefined"!==typeof m.item.fnote&&!0===f.options.pattern){var v=m.note.getCurrentInlineStyle(),g=m.note.getSelection(),x=m.note.getCurrentContent().getBlockForKey(g.getStartKey()).getType();return Object(N.jsxs)(u.Fragment,{children:[Object(N.jsx)("div",{className:"row full",children:Object(N.jsx)("div",{className:"cell",children:Object(N.jsx)("button",{className:" ".concat(O.a.tabButton," ","full secondary-title"),onClick:function(){return r("fnote")},children:Object(N.jsx)("div",{className:"row full",children:Object(N.jsx)("div",{className:"cell",children:Object(N.jsx)(_.d,{text:"fnote_view",leftIcon:Object(N.jsx)(y.v,{}),col:20})})})})})}),"fnote"===m.view?Object(N.jsxs)("div",{className:"".concat(O.a.formPanel," ","border"),children:["readonly"!==p?Object(N.jsx)("div",{children:Object(N.jsx)("div",{className:"row full",children:Object(N.jsxs)("div",{className:"cell padding-small",children:[Object(N.jsxs)("div",{className:"cell padding-tiny",children:[Object(N.jsx)("button",{className:"border-button".concat(" ",O.a.barButton),title:a("pattern_default"),onClick:function(){return i("default")},children:Object(N.jsx)(y.L,{})}),Object(N.jsx)("button",{className:"border-button".concat(" ",O.a.barButton),title:a("pattern_load"),onClick:function(){return i("load")},children:Object(N.jsx)(y.A,{})}),Object(N.jsx)("button",{className:"border-button".concat(" ",O.a.barButton),title:a("pattern_save"),onClick:function(){return i("save")},children:Object(N.jsx)(y.zb,{})})]}),Object(N.jsxs)("div",{className:"cell padding-tiny",children:[Object(N.jsx)("button",{className:"border-button".concat(" ",O.a.barButton),title:a("pattern_new"),onClick:function(){return i("new")},children:Object(N.jsx)(y.bb,{})}),Object(N.jsx)("button",{className:"border-button".concat(" ",O.a.barButton),title:a("pattern_delete"),onClick:function(){return i("delete")},children:Object(N.jsx)(y.tb,{})})]}),Object(N.jsx)("div",{className:"cell padding-tiny mobile",children:Object(N.jsx)(_.e,{value:m.template,placeholder:"",onChange:function(e){return c(e.target.value)},options:j.pattern.map((function(e){return{value:e.id,text:e.description+(1===e.defpattern?"*":"")}}))})})]})})}):null,Object(N.jsx)("div",{className:"row full",children:Object(N.jsxs)("div",{className:"cell padding-small border-bottom".concat(" ",O.a.viewPanel),children:[Object(N.jsx)("div",{className:"cell padding-tiny",children:o.map((function(e){return Object(N.jsx)("button",{title:e.label,className:"border-button".concat(" ",O.a.barButton," ").concat(v.has(e.style)?O.a.activeStyle:""),onClick:function(){return n(e.style)},children:Object(u.createElement)(e.icon)},e.label)}))}),Object(N.jsx)("div",{className:"cell padding-tiny",children:s.map((function(e){return Object(N.jsx)("button",{title:e.label,className:"border-button".concat(" ",O.a.barButton," ").concat(e.style===x?O.a.activeStyle:""),onClick:function(){return n(e.style)},children:Object(u.createElement)(e.icon)},e.label)}))})]})}),Object(N.jsx)("div",{className:"".concat(O.a.rtfEditor," ","rtf"),children:Object(N.jsx)(b.Editor,{editorState:m.note,onChange:t})})]}):null]})}return null}),(function(e,t){return e.data===t.data})),I=Object(u.memo)((function(e){var t=e.getText,r=e.editItem,n=e.data,a=n.current,c=n.audit,i=n.dataset;return Object(N.jsxs)(u.Fragment,{children:[Object(N.jsx)("div",{className:"row full",children:Object(N.jsxs)("div",{className:"cell padding-normal border secondary-title".concat(" ",O.a.itemTitle),children:[Object(N.jsx)(_.d,{className:" ".concat(O.a.itemTitlePre),value:null===a.form.id?t("label_new"):a.form.id}),Object(N.jsx)(_.d,{value:a.form_template.options.title})]})}),Object(N.jsx)("div",{className:"".concat(O.a.formPanel," ","border"),children:a.form_template.rows.map((function(e,t){return Object(N.jsx)(_.b,{row:e,values:a.form,rowdata:{audit:c,current:a,dataset:i,onEdit:r}},t)}))})]})}),(function(e,t){return e.data===t.data})),T=Object(u.memo)((function(e){var t=e.data,r=t.current,a=t.caption,c=t.template,i=e.theme;return Object(N.jsx)(u.Fragment,{children:Object(N.jsx)("div",{className:"page padding-normal".concat(" ",i),children:Object(N.jsx)("div",{className:"".concat(O.a.width800),children:Object(N.jsxs)("div",{className:"panel",children:[Object(N.jsx)("div",{className:"panel-title primary",children:Object(N.jsx)(_.d,{bold:!0,primary:!0,xxxlarge:!0,value:a,leftIcon:Object(u.createElement)(c.options.icon),col:20})}),r.form?Object(N.jsx)("div",{className:"section container",children:Object(N.jsx)(I,Object(n.a)({},e))}):Object(N.jsxs)("div",{className:"section container",children:[Object(N.jsx)(F,Object(n.a)({},e)),Object(N.jsx)($,Object(n.a)({},e)),Object(N.jsx)(C,Object(n.a)({},e)),Object.keys(c.view).filter((function(e){return"disabled"!==c.view[e].view_audit})).map((function(t){return Object(N.jsx)(E,Object(n.a)({vname:t},e),t)}))]})]})})})})}),(function(e,t){return e.data===t.data})),P=r(25);t.default=function(e){var t=Object(u.useContext)(f.b),r=t.data,a=t.setData,s=Object(j.a)(),x=Object(p.e)(),O=Object(v.a)(),_=Object(P.e)(),h=Object(u.useState)({engine:r.login.data.engine,ui:x.getSetting("ui"),theme:r.current.theme}),y=Object(o.a)(h,1)[0];y.data=r.edit,y.viewerRef=Object(u.useRef)(null),y.canvasRef=Object(u.useRef)(null),Object(u.useEffect)((function(){Object(g.b)(y.viewerRef.current,y.canvasRef.current,y.data.preview)}),[y.viewerRef,y.canvasRef,y.data.preview]),y.getText=function(e,t){return x.getText(e,t)},y.formatNumber=function(e,t){return(isNaN(parseFloat(e))?0:parseFloat(e)).toFixed(t).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},y.changeData=function(e,t){a("edit",Object(l.a)({},e,t))},y.onPaginationSelect=function(e,t){var n=Math.ceil(t/r.edit.current.pagination.perPage),c=Math.min(Math.max(e,1),n),i=d()(r.edit.current,{$merge:{pagination:d()(r.edit.current.pagination,{$merge:{page:c}})}});a("edit",{current:i})},y.checkEditor=function(e,t,r){s.checkEditor(e,t,r)},y.currentView=function(e){var t=d()(r.edit.current,{$merge:{view:r.edit.current.view===e?"":e}});a("edit",{current:t})};var w=function(){var e=Object(i.a)(c.a.mark((function e(t,r){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",data:{key:"getPriceValue",values:{vendorprice:r.vendorprice,product_id:r.product_id,posdate:t.transdate,curr:t.curr,qty:r.qty,customer_id:t.customer_id}}},e.abrupt("return",x.requestData("/function",n));case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),k=function(e,t){var n=r.edit.dataset.tax.filter((function(e){return e.id===parseInt(t.tax_id,10)}))[0];n="undefined"!==typeof n?n.rate:0;var a=r.edit.dataset.currency.filter((function(e){return e.curr===r.edit.current.item.curr}))[0];a="undefined"!==typeof a?a.digit:2;var c=0,i=0,l=0,o=0;switch(e){case"fxprice":o=parseFloat(t.fxprice),c=s.round(o*(1-parseFloat(t.discount)/100)*parseFloat(t.qty),parseInt(a,10)),i=s.round(o*(1-parseFloat(t.discount)/100)*parseFloat(t.qty)*parseFloat(n),parseInt(a,10)),l=s.round(c+i,parseInt(a,10));break;case"netamount":c=parseFloat(t.netamount),0!==parseFloat(t.qty)&&(o=s.round(c/(1-parseFloat(t.discount)/100)/parseFloat(t.qty),parseInt(a,10)),i=s.round(c*parseFloat(n),parseInt(a,10))),l=s.round(c+i,parseInt(a,10));break;case"amount":l=parseFloat(t.amount),0!==parseFloat(t.qty)&&(c=s.round(l/(1+parseFloat(n)),parseInt(a,10)),i=s.round(l-c,parseInt(a,10)),o=s.round(c/(1-parseFloat(t.discount)/100)/parseFloat(t.qty),parseInt(a,10)))}return d()(t,{$merge:{fxprice:o,netamount:c,vatamount:i,amount:l}})};return y.editItem=function(){var e=Object(i.a)(c.a.mark((function e(t){var r,n,i,o,u,m,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d()({},{$set:y.data}),"fieldvalue_value"!==t.name&&"fieldvalue_notes"!==t.name&&"fieldvalue_deleted"!==t.name){e.next=6;break}(n=r.current.fieldvalue.findIndex((function(e){return e.id===t.id})))>-1&&("all"===r.audit||"update"===r.audit)&&(r=d()(r,{$merge:{dirty:!0}}),r=d()(r,{current:{fieldvalue:Object(l.a)({},n,{$merge:Object(l.a)({},t.name.split("_")[1],"fieldvalue_deleted"===t.name?1:t.value.toString())})}})),e.next=95;break;case 6:if(!r.current.form){e.next=53;break}"undefined"!==typeof(r=d()(r,{$merge:{form_dirty:!0}})).current.form[t.name]&&(r=d()(r,{current:{form:{$merge:Object(l.a)({},t.name,t.value)}}})),e.t0=r.current.form_type,e.next="item"===e.t0?12:"price"===e.t0||"discount"===e.t0?44:"invoice_link"===e.t0?46:"payment_link"===e.t0?48:50;break;case 12:if("product_id"!==t.name||"undefined"===typeof t.item){e.next=24;break}return 0===(r=d()(r,{current:{form:{$merge:{description:t.item.description,unit:t.item.unit,tax_id:parseInt(t.item.tax_id,10)}}}})).current.form.qty&&(r=d()(r,{current:{form:{$merge:{qty:1}}}})),e.next=17,w(r.current.item,r.current.form);case 17:if(!(i=e.sent).error){e.next=20;break}return e.abrupt("return",x.resultError(i));case 20:r=d()(r,{current:{form:{$merge:{fxprice:isNaN(parseFloat(i.price))?0:parseFloat(i.price),discount:isNaN(parseFloat(i.discount))?0:parseFloat(i.discount)}}}}),r=d()(r,{current:{$merge:{form:k("fxprice",r.current.form)}}}),e.next=43;break;case 24:e.t1=t.name,e.next="qty"===e.t1?27:"fxprice"===e.t1||"tax_id"===e.t1||"discount"===e.t1?36:"amount"===e.t1?38:"netamount"===e.t1?40:42;break;case 27:if(0!==parseFloat(r.current.form.fxprice)){e.next=34;break}return e.next=30,w(r.current.item,r.current.form);case 30:if(!(o=e.sent).error){e.next=33;break}return e.abrupt("return",x.resultError(o));case 33:r=d()(r,{current:{form:{$merge:{fxprice:isNaN(parseFloat(o.price))?0:parseFloat(o.price),discount:isNaN(parseFloat(o.discount))?0:parseFloat(o.discount)}}}});case 34:case 36:return r=d()(r,{current:{$merge:{form:k("fxprice",r.current.form)}}}),e.abrupt("break",43);case 38:return r=d()(r,{current:{$merge:{form:k("amount",r.current.form)}}}),e.abrupt("break",43);case 40:return r=d()(r,{current:{$merge:{form:k("netamount",r.current.form)}}}),e.abrupt("break",43);case 42:return e.abrupt("break",43);case 43:return e.abrupt("break",51);case 44:return"customer_id"===t.name&&(r=d()(r,{current:{$merge:{price_customer_id:t.value}}})),e.abrupt("break",51);case 46:return"ref_id_1"===t.name&&"undefined"!==typeof t.item?r=d()(r,{current:{invoice_link:{0:{$merge:{curr:t.item.curr}}}}}):"link_qty"!==t.name&&"link_rate"!==t.name||(r=d()(r,{current:{$merge:{invoice_link_fieldvalue:s.setFieldvalue(r.current.invoice_link_fieldvalue,t.name,r.current.form.id,null,t.value)}}})),e.abrupt("break",51);case 48:return"ref_id_2"===t.name&&"undefined"!==typeof t.item?r=d()(r,{current:{payment_link:{0:{$merge:{curr:t.item.curr}}}}}):"link_qty"!==t.name&&"link_rate"!==t.name||(r=d()(r,{current:{$merge:{payment_link_fieldvalue:s.setFieldvalue(r.current.payment_link_fieldvalue,t.name,r.current.form.id,null,t.value)}}})),e.abrupt("break",51);case 50:return e.abrupt("break",51);case 51:e.next=95;break;case 53:"undefined"!==typeof r.current.item[t.name]&&!1===t.extend?r=d()(r,{current:{item:{$merge:Object(l.a)({},t.name,t.value)}}}):"undefined"!==typeof r.template.options.extend&&!0===t.extend&&(r=d()(r,{current:{extend:{$merge:Object(l.a)({},t.name,t.value)}}})),"all"!==r.audit&&"update"!==r.audit||(r=d()(r,{$merge:{dirty:!0}})),e.t2=r.current.type,e.next="report"===e.t2?58:"printqueue"===e.t2?61:"trans"===e.t2?64:94;break;case 58:return r=d()(r,{$merge:{dirty:!1}}),"selected"===t.name?(u=r.current.fieldvalue.findIndex((function(e){return e.id===t.id})))>-1&&(r=d()(r,{current:{fieldvalue:Object(l.a)({},u,{$merge:{selected:t.value}})}})):(m=r.current.fieldvalue.findIndex((function(e){return e.name===t.name})))>-1&&(r=d()(r,{current:{fieldvalue:Object(l.a)({},m,{$merge:{value:t.value}})}})),e.abrupt("break",95);case 61:return r=d()(r,{$merge:{dirty:!1}}),r=d()(r,{printqueue:{$merge:Object(l.a)({},t.name,t.value)}}),e.abrupt("break",95);case 64:e.t3=t.name,e.next="closed"===e.t3?67:"paiddate"===e.t3?69:"direction"===e.t3?71:"seltype"===e.t3?73:"ref_id"===e.t3?75:"trans_wsdistance"===e.t3||"trans_wsrepair"===e.t3||"trans_wstotal"===e.t3||"trans_reholiday"===e.t3||"trans_rebadtool"===e.t3||"trans_reother"===e.t3||"trans_wsnote"===e.t3||"trans_rentnote"===e.t3?87:"shippingdate"===e.t3||"shipping_place_id"===e.t3?89:92;break;case 67:return 1===t.value&&_({title:x.getText("msg_warning"),message:x.getText("msg_close_text"),infoText:x.getText("msg_delete_info"),onChange:function(e){a("current",{modalForm:e})},cbCancel:function(){a("current",{modalForm:null},(function(){r=d()(r,{current:{item:{$merge:Object(l.a)({},t.name,0)}}}),a("edit",r)}))},cbOK:function(e){a("current",{modalForm:null},(function(){r=d()(r,{current:{$merge:{closed:1}}}),a("edit",r)}))}}),e.abrupt("break",93);case 69:return r=d()(r,{current:{item:{$merge:{transdate:t.value}}}}),e.abrupt("break",93);case 71:return"cash"===r.current.transtype&&(b=r.dataset.groups.filter((function(e){return e.id===t.value}))[0].groupvalue,r=d()(r,{template:{options:{$merge:{opposite:"out"===b}}}})),e.abrupt("break",93);case 73:return r=d()(r,{current:{extend:{$merge:{seltype:t.value,ref_id:null,refnumber:""}},item:{$merge:{customer_id:null,employee_id:null,ref_transnumber:null}}}}),e.abrupt("break",93);case 75:r=d()(r,{current:{extend:{$merge:{refnumber:t.refnumber,ntype:"transitem"===r.current.extend.seltype?"trans":r.current.extend.seltype,transtype:t.item&&t.item.transtype?t.item.transtype.split("-")[0]:""}}}}),e.t4=r.current.extend.seltype,e.next="customer"===e.t4?79:"employee"===e.t4?81:"transitem"===e.t4?83:85;break;case 79:return r=d()(r,{current:{item:{$merge:{customer_id:t.value}}}}),e.abrupt("break",86);case 81:return r=d()(r,{current:{item:{$merge:{employee_id:t.value}}}}),e.abrupt("break",86);case 83:return r=d()(r,{current:{item:{$merge:{ref_transnumber:t.refnumber}}}}),e.abrupt("break",86);case 85:return e.abrupt("break",86);case 86:return e.abrupt("break",93);case 87:return r=d()(r,{current:{$merge:{fieldvalue:s.setFieldvalue(r.current.fieldvalue,t.name,r.current.item.id,null,t.value)}}}),e.abrupt("break",93);case 89:return r=d()(r,{$merge:{dirty:!1}}),r=d()(r,{current:{$merge:Object(l.a)({},t.name,t.value)}}),e.abrupt("break",93);case 92:return e.abrupt("break",93);case 93:case 94:return e.abrupt("break",95);case 95:a("edit",r);case 96:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y.noteState=function(e){var t=d()(r.edit,{current:{$merge:{note:["unordered-list-item","ordered-list-item"].includes(e)?b.RichUtils.toggleBlockType(r.edit.current.note,e):b.RichUtils.toggleInlineStyle(r.edit.current.note,e)}}});a("edit",t)},y.noteTemplate=function(e){var t=d()(r.edit,{current:{$merge:{template:e}}});a("edit",t)},y.setPattern=function(e){var t=function(){var e=Object(i.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",data:t},e.next=3,x.requestData("/pattern",n);case 3:if(!(a=e.sent).error){e.next=6;break}return e.abrupt("return",x.resultError(a));case 6:s.checkEditor({ntype:r.edit.current.type,ttype:r.edit.current.transtype,id:r.edit.current.item.id,form:"fnote"},"LOAD_EDITOR");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if("new"!==e&&(!r.edit.current.template||""===r.edit.current.template))return x.showToast({type:"error",title:x.getText("msg_warning"),message:x.getText("msg_pattern_missing")});switch(e){case"default":_({title:x.getText("msg_warning"),message:x.getText("msg_pattern_default"),onChange:function(e){a("current",{modalForm:e})},cbCancel:function(){a("current",{modalForm:null})},cbOK:function(e){a("current",{modalForm:null},(function(){var e=d()(r.edit.dataset.pattern,{});e.forEach((function(t,n){e=d()(e,Object(l.a)({},n,{$merge:{defpattern:t.id===parseInt(r.edit.current.template,10)?1:0}}))})),t(e)}))}});break;case"load":var n=r.edit.dataset.pattern.filter((function(e){return e.id===parseInt(r.edit.current.template,10)}))[0];if(n){var o=d()(r.edit,{current:{item:{$merge:{fnote:n.notes}}}});o=d()(o,{current:{$merge:{note:b.EditorState.createWithContent(Object(m.a)(n.notes||""))}}}),o=d()(o,{$merge:{dirty:!0}}),a("edit",o)}break;case"save":_({title:x.getText("msg_warning"),message:x.getText("msg_pattern_save"),onChange:function(e){a("current",{modalForm:e})},cbCancel:function(){a("current",{modalForm:null})},cbOK:function(e){a("current",{modalForm:null},(function(){var e=r.edit.dataset.pattern.filter((function(e){return e.id===parseInt(r.edit.current.template,10)}))[0];e&&(e=d()(e,{$merge:{notes:r.edit.current.item.fnote}}),t([e]))}))}});break;case"new":_({title:x.getText("msg_pattern_new"),message:x.getText("msg_pattern_name"),value:"",onChange:function(e){a("current",{modalForm:e})},cbCancel:function(){a("current",{modalForm:null})},cbOK:function(e){a("current",{modalForm:null},Object(i.a)(c.a.mark((function n(){var a,i;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(""===e){n.next=10;break}return n.next=3,x.requestData("/pattern?filter=description;==;"+e,{});case 3:if(!(a=n.sent).error){n.next=6;break}return n.abrupt("return",x.resultError(a));case 6:if(!(a.length>0)){n.next=8;break}return n.abrupt("return",x.showToast({type:"error",title:x.getText("msg_warning"),message:x.getText("msg_value_exists")}));case 8:i=d()(O({tablename:"pattern",current:r.edit.current}),{$merge:{description:e,defpattern:0===r.edit.dataset.pattern.length?1:0}}),t([i]);case 10:case"end":return n.stop()}}),n)}))))}});break;case"delete":_({title:x.getText("msg_warning"),message:x.getText("msg_delete_text"),infoText:x.getText("msg_delete_info"),onChange:function(e){a("current",{modalForm:e})},cbCancel:function(){a("current",{modalForm:null})},cbOK:function(e){a("current",{modalForm:null},(function(){var e=r.edit.dataset.pattern.filter((function(e){return e.id===parseInt(r.edit.current.template,10)}))[0];e&&(e=d()(e,{$merge:{deleted:1,defpattern:0}}),t([e]))}))}})}},y.noteChange=function(e){var t=d()(r.edit,{current:{$merge:{note:e}}});t=d()(t,{current:{item:{$merge:{fnote:Object(m.b)(e.getCurrentContent())}}}}),t=d()(t,{$merge:{dirty:!0}}),a("edit",t)},y.setActions=function(e,t){s.setFormActions(e,t,y.data)},y.data.current.item?y.data.preview?Object(N.jsx)(g.a,Object(n.a)({},y)):Object(N.jsx)(T,Object(n.a)({},y)):Object(N.jsx)("div",{})}}}]);